FROM archlinux:latest

# dernière version de nginx utilisant openssl 3
RUN pacman -Syu --noconfirm nginx-mainline

# copie de openssl version 3.0.5 vulnérable
COPY libcrypto.so.3 /usr/lib/

# config de nginx
COPY nginx.conf /etc/nginx/

WORKDIR /challenge
COPY certs certs/
# RUN ls certs

CMD ["nginx"]

# Décommenter pour vérifier la version d'openSSL utilisée
# nginx version: nginx/1.23.3
# built with OpenSSL 3.0.7 1 Nov 2022 (running with OpenSSL 3.0.5 5 Jul 2022)
# CMD ["nginx" , "-V"]
