const { createServer } = require('https')
const { readFileSync } = require('fs')

const options = {
	key:  readFileSync('./certs/ca.key'),
	cert: readFileSync('./certs/ca.crt'),
	requestCert: true, // requiert l'authentification avec un certificat client
	// c'est ce qui rend le serveur vulnÃ©rable
}

console.log("loaded openssl version: " + process.versions.openssl)

const serv = createServer(options, (req, res) => {
	console.log(req)
	res.writeHead(200, { 'Content-Type': 'text/html' })
	res.write('ok')
	res.end()
})

serv.listen(8080, () => {
	console.log('https://localhost:8080')
})
